1. LDAP - LightWeight Directory Access Protocol / Active Directory / DB
2. Authentication vs Authorization

Steps
1. Add spring-security-web & spring-security-config & commons-logging maven dependency
2. Configure filter springSecurityFilter using DelegatingFilterProxy Class
 <filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
  </filter>

  <filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping>
3.Create spring-security.xml under webapp/WEB-INF with security namespace and xsd
<!--    http interceptor intercepts the requests and does authentication-->
    <security:http auto-config="true" use-expressions="false">
            <security:intercept-url pattern="/**" access="ROLE_USER" />
        </security:http>

<!--    authentication manager defines the users who can access the application-->
    <security:authentication-manager>
        <security:authentication-provider>
            <security:user-service>
            <!--perform single user authentication -->
                <security:user name="naga" authorities="ROLE_USER" />
            </security:user-service>
        </security:authentication-provider>
    </security:authentication-manager>
4. Update the <context-param> with security-config.xml in the web.xml
<!--    Location of the XML files that defines root application context
    Applied by ContextLoaderListener-->
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>classpath:spring/app-config.xml,/WEB-INF/security-config.xml</param-value>
    </context-param>

-------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------
Multi User Database Authentication
1. Copy security-config.xml to security-db-config.xml
2. Update context-param in web.xml to point to security-db-config.xml
3. Create users and authorities table
// contains user information
create table users(
  username varchar(100) not null primary key,
  password varchar(100) not null,
  enabled boolean not null
);

//contains username and role which the user is in
create table authorities(
  username varchar(100) not null,
  authority varchar(50) not null,
  constraint fk_username_users
  foreign key(username) references users(username)
);

//create unique index using username and authority
create unique index idx_username on authorities(username, authority);

4.  Create users and authorities
insert into users values('naga',  'admin', true);
insert into users values('baba',  'admin', true);
insert into authorities values('naga','ROLE_USER');
insert into authorities values('baba','ROLE_USER');

5. Configure authentication-manager in security-db-config.xml to use <security:jdbc-user-service>
    <!--authentication manager - multi user authentication using db- <security:jdbc-user-service> dataSource is defined in app-config.xml-->
    <!--    authentication manager defines the users who can access the application-->
    <security:authentication-manager>
        <security:authentication-provider>
            <security:jdbc-user-service data-source-ref="dataSource"/>
        </security:authentication-provider>
    </security:authentication-manager>

6. Defining Multiple Roles - Comma Separated User Roles
    6a. Comma separated - Worked
        <!--    http interceptor intercepts the requests and does authentication-->
        <security:http auto-config="true" use-expressions="false">
            <security:intercept-url pattern="/**" access="ROLE_USER,ROLE_ADMIN"/>
        </security:http>

    6b. Defining one more <security:intercept-url> element - Did not work
            <!--Defining multiple roles-Using a new <security:intercept-url> element-->
            <security:intercept-url pattern="/**" access="ROLE_USER"/>
            <security:intercept-url pattern="/**" access="ROLE_ADMIN"/>

-------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------
1. create security-custom-login-config.xml using security-db-config.xml
Update <security:http> element
    <!--    http interceptor intercepts the requests and does authentication-->
    <!-- use-expressons should be true; by default it is true-->
    <security:http auto-config="true">
        <security:intercept-url pattern="/login" access="permitAll()"/>
        <security:intercept-url pattern="/logout" access="permitAll()"/>
        <security:intercept-url pattern="/accessDenied" access="permitAll()"/>
        <security:intercept-url pattern="/**" access="hasRole('ROLE_USER')"/>
        <security:form-login login-page="/login" username-parameter="username" password-parameter="password"
                             default-target-url="/" authentication-failure-url="/accessDenied" />
    </security:http>
2. Update <context-param> element in web.xml with security-custom-login-config.xml
3. Create the LoginController with @Controller annotation
//When user logsout kill the session
    @RequestMapping(value = "/accessDenied", method = RequestMethod.GET)
    public String performLogout(HttpServletRequest request, HttpServletResponse response){
        //kill the session
        //load authentication object from Spring Security Context
        Authentication authentication = SecurityContextHolder.getContext().getAuthentication();
        if(authentication != null){
            //perform a logout
            new SecurityContextLogoutHandler().logout(request, response, authentication);
        }
        return "redirect:/login";
    }
4. Create jsp pages for accessDenied, login and logout
